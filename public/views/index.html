<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<!-- This section gives the unauthenticated user access to all of the files that are stored in the Content folder.  -->
	<location path="/public">
		<system.web>
			<authorization>
				<allow users="*" />
			</authorization>
		</system.web>
	</location>
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<link rel="stylesheet" type="text/css" href="{{ url_for('public', path='/styles.css') }}" />
	<title>Audio Insights</title>
</head>

<body>
	<div class="container">
		<div class="header">
			<div class="nav">
				<div class="nav-left">
					<a>
						<img src="{{ url_for('public', path='/images/nav-logo.png') }}" alt="nav-logo">
					</a>
				</div>
				<div class="nav-right">
					<a>Help</a>
				</div>
			</div>
		</div>
		<div class="main">
			<div class="center-screen">
				<div class="audio-symbol">
					<img src="{{ url_for('public', path='/images/nav-logo.png') }}" alt="page-logo">
				</div>
				<div class="display">
				</div>
				<div class="controllers">
				</div>
				<form id="form_audio" action="" method="post" enctype="multipart/form-data">
					<p><input type="file" accept="audio/*" id="input_audio" class="inputs" name="audio_file" capture>
					<p><button type="submit" id="button_audio" class="listen-button">Submit</button>
				</form>
				<h3 id="test">Response Data is displayed here...</h3>
			</div>
			<div class="footer"></div>
		</div>
</body>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="{{ url_for('public', path='/javascript/vrecorder.js') }}"></script>
<script>
	var form = document.getElementById('form_audio');
	var fileSelect = document.getElementById('input_audio');
	var uploadButton = document.getElementById('button_audio');
	form.onsubmit = function (event) {
		event.preventDefault();

		// Update button text.
		uploadButton.innerHTML = 'Uploading...';

		const audioURL = document.querySelector('audio')
		var audio = null;
		// Return if no file is selected.
		if (fileSelect.files.length > 0) {
			audio = fileSelect.files[0];
		}
		if (audioURL != null) {
			<!-- audio = audioURL.src; -->
		}
		if (audio == null) {
			return;
		}
		// Create a new FormData object.
		var formData = new FormData();

		// Add the file to the request.
		formData.append('audio_file', audio, audio.name);
		// Set up the request.
		var xhr = new XMLHttpRequest();
		// Open the connection.
		xhr.open('POST', '/uploadfile/', true);
		// Set up a handler for when the request finishes.
		xhr.onload = function () {
			if (xhr.status === 200) {
				// File(s) uploaded.
				uploadButton.innerHTML = 'Upload';
			} else {
				alert('An error occurred!');
			}
		};
		// Send the Data.
		xhr.send(formData);
	}
</script>

</html>